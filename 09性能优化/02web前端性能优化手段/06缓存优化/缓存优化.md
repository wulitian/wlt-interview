#### 缓存优化

1. http缓存
- Cache-Control的一些属性
  max-age，过期时间。
  no-cache: 不使用强缓存（但仍会使用    商缓存）。
  no-store: 不使用缓存（不使用强缓存也不使用协商缓存），每次都向服务器发送资源请求。
  private： 只允许客户端使用缓存，不允许其他代理服务器进行缓存。
  public: 客户端和代理服务器都可缓存。
  s-maxage: 与max-age类似，区别是s-maxage是设定代理服务器的缓存时间。
- 强缓存
  浏览器第一次请求远程服务器的某个资源时，如果服务器希望浏览器得到该资源后一段时间内不要再发送请求过来，直接从浏览器里的缓存里取，
  则服务器可以通过在响应头里设置Cache-Control: max-age=31536000，max-age代表缓存时间，单位为秒，这里的数据换算过来就是一年，意味着在一年内浏览器不会再向服务器发送请求。
  使用缓存的话，状态码200后面会标明情况。浏览器缓存资源的地方有两个：磁盘缓存（disk cache）和内存缓存（memory cache）。
  当缓存时间到期后再次访问时，状态码200后面便没有括号内的内容了。
  一般来说，浏览器会将较大的资源缓存到disk cache，而较小的资源则被缓存到memory cache里。内存缓存与磁盘缓存相比，访问速度要更快一些！
  强缓存除了使用Cache-Control实现之外，还可以使用Expires字段，Expires是Http1.0规范，Cache-Control是Http1.1规范，Expires返回一个具体的时间值，代表缓存的有效期，在该日期内浏览器不会向服务器发起请求，而是直接从缓存里获取资源。
```
Expires:Mon,18 Oct 2066 23:59:59 GMT
这个时间代表着这个资源的失效时间，在此时间之前，即命中缓存。这种方式有一个明显的缺点，由于失效时间是一个绝对时间，所以当服务器与客户端时间偏差较大时，就会导致缓存混乱。
Cache-Control:max-age=3600
代表着资源的有效期是3600秒
```
- 协商缓存
  在强缓存里，是否使用缓存是由浏览器来确定的，而协商缓存则是由服务器来告诉浏览器是否使用缓存资源，也就是浏览器每一次都要发送请求到服务器询问是否使用缓存，协商缓存的具体流程如下：
  浏览器初次请求资源，服务器返回资源，同时生成一个Etag值携带在响应头里返回给浏览器，当浏览器再次请求资源时会在请求头里携带If-None-Match，值是之前服务器返回的Etag的值，服务器收到之后拿该值与资源文件最新的Etag值做对比。
  如果没有变化则返回304，告诉浏览器继续使用缓存（不返回资源文件）。
  如果发生变化，则返回200和最新的资源文件给浏览器使用。
  除了Etag外，还有一个Last-Modified的属性，它是Http1.0规范的，服务器返回Last-Modified，浏览器请求头对应携带的是If-Modified-since，
  与Etag不同的是，Last-Modified的值是一个时间值，代表文件的修改时间，服务器通过对比文件的修改时间是否发生改变来判断是否使用缓存。
  相比Last-Modified，Etag优先级更高，使用上也更精确一些，因为有时候会存在文件内容并没有改变，但文件的修改时间变更了，Last-Modified不一致所以服务器会重新返回资源文件，实际上还是可以继续使用缓存的。
  强缓存优先级大于协商缓存，即两者同时存在时，如果强缓存开启且在有效期内，则不会走协商缓存。
```
Last-Modified: Thu, 06 May 2021 15:49:24 GMT // 响应头
If-Modified-Since: Thu, 06 May 2021 15:49:24 GMT // 请求头

Etag: "12274-tEuUYy8halvEHeM+olO/cV8mQ8A" // 响应头
If-None-Match: "12274-tEuUYy8halvEHeM+olO/cV8mQ8A" // 响应头
```   
2. Server Worker缓存
   一般可以在网络请求较快的时候缓存一些网络资源，当网络请求过慢时读取这些缓存。
3. Push缓存
   一般使用http2，的push机制在网络处于空闲阶段可以提前推送
4. CDN缓存
   可以使用较近的缓存节点，为了突破同域名请求上限可以使用多个子域名，chrome的同域名访问上线为6