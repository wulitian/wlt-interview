<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>wulitian-study</title>
    <style>
        .box{
        }
    </style>
</head>
<body id="box">
<button onclick="debounce(foo(),20000)">防抖</button>
<button onclick="debounce(foo(),20000)">节流</button>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<div class="box">1212</div>
<script>
    function debounce(fn, delay) {
        // 维护一个 timer，用来记录当前执行函数状态
        let timer = null;
        return function() {
            // 通过 ‘this’ 和 ‘arguments’ 获取函数的作用域和变量
            let context = this;
            let args = arguments;
            // 清理掉正在执行的函数，并重新执行
            clearTimeout(timer);
            timer = setTimeout(function() {
                fn.apply(context, args);
            }, delay);
        }
    }
    function throttle(func, delay){
        let prev = Date.now();
        return function(){
            const context = this;
            const args    = arguments;
            const now     = Date.now();
            if(now - prev >= delay){
                func.apply(context, args);
                prev = Date.now();
            }
        }
    }
    let flag = 0; // 记录当前函数调用次数
    // 当用户滚动时被调用的函数
    function foo() {
        flag++;
        console.log('Number of calls: %d', flag);
    }
    // 在 debounce 中包装我们的函数，过 2 秒触发一次
    document.body.addEventListener('click', throttle(foo, 2000));

</script>
</body>
</html>
